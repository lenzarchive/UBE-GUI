<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UnityBundleExtractor - GUI</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header>
            <h1>UnityBundleExtractor GUI</h1>
            <p class="subtitle">A web-based tool for analyzing and extracting Unity asset bundles.</p>
        </header>

        <main>
            <div class="upload-section card">
                <h2>1. Upload Bundle File</h2>
                <form id="upload-form" enctype="multipart/form-data">
                    <label for="file-input" class="custom-file-upload-label">
                        <span id="custom-file-upload-text">Drag & Drop or Choose Unity Main File(s) (.bundle, .unity3d, .assets, .unitybundle)</span>
                        <input type="file" id="file-input" name="files" accept=".bundle,.unity3d,.assets,.unitybundle">
                    </label>
                    
                    <div id="optional-upload-section" class="upload-section card" style="display: none; margin-top: 1rem; padding: 1rem;">
                        <h3>Optional: Additional Resource Files</h3>
                        <label for="optional-file-input" id="optional-upload-area" class="custom-file-upload-label custom-file-upload-label-small">
                            <span id="optional-file-upload-text">Drag & Drop any .resS or other related files here (optional)</span>
                        </label>
                        <input type="file" id="optional-file-input" name="optional_files" accept=".*" multiple>
                        <ul id="additional-files-list"></ul>
                    </div>


                    <div class="options">
                        <label>
                            <input type="checkbox" id="send-log-checkbox" name="send_log" value="true">
                            Send anonymous log to server on error (helps development)
                        </label>
                        <label>
                            <input type="checkbox" id="allow-storage-checkbox" name="allow_storage" value="true">
                            Allow server to keep my file for debug purposes (helps development)
                        </label>
                    </div>
                    <button type="submit" id="upload-button">Analyze Bundle</button>
                </form>
                <div id="progress-bar" class="progress-bar" style="display: none;">
                    <div id="progress-bar-inner" class="progress-bar-inner"></div>
                </div>
                <div id="queue-info" class="status-message" style="display: none;"></div>
                <div id="queue-controls" style="display: none; margin-top: 1rem; justify-content: center; gap: 10px;">
                    <button id="cancel-queue-button" class="action-button cancel-button">Cancel This Task</button>
                </div>
            </div>

            <div id="results-section" class="results-section" style="display: none;">
                <div class="card">
                    <h2>2. Analysis Results</h2>
                    <div id="metadata-info"></div>
                </div>

                <div class="asset-section-grid">
                    <div class="card" id="asset-classes-card">
                        <h3>Asset Classes</h3>
                        <div id="asset-classes-list"></div>
                    </div>

                    <div class="card" id="asset-list-card">
                        <h3>Asset List</h3>
                        <div class="asset-viewer">
                            <div class="toolbar">
                                <button id="select-all-button">Select All</button>
                                <button id="deselect-all-button">Deselect All</button>
                                <input type="text" id="filter-input" placeholder="Filter assets by name...">
                            </div>
                            <div id="asset-list-container"></div>
                        </div>
                        <button id="extract-button" disabled>Extract Selected as .ZIP</button>
                    </div>
                </div>
            </div>

            <div id="status-message" class="status-message"></div>

            <div id="error-info-card" class="card error-card" style="display: none;">
                <h2 style="color: var(--error-color);">Processing Error</h2>
                <div id="error-info-content">
                    
                </div>
            </div>

        </main>

        <footer>
            <div class="card">
                <div class="footer-grid">
                    <div class="footer-column">
                        <strong>Support the Project</strong>
                        <div class="donation-links">
                            <a href="#" id="btc-link">BTC</a> |
                            <a href="https://ko-fi.com/alwizba" target="_blank">Ko-fi</a> |
                            <a href="https://saweria.co/alwizba" target="_blank">Saweria</a>
                        </div>
                        <span id="btc-address" style="display: none;">Click address to copy</span>
                    </div>
                    <div class="footer-column">
                        <strong>Find Me On</strong>
                        <div class="social-links">
                            <a href="https://github.com/lenzarchive" target="_blank">GitHub</a> |
                            <a href="https://tiktok.com/@alwizba" target="_blank">TikTok</a> |
                            <a href="https://youtube.com/@alenforce" target="_blank">YouTube</a> |
                            <a href="https://facebook.com/alwizba" target="_blank">Facebook</a>
                        </div>
                    </div>
                    <div class="footer-column">
                        <strong>Resources</strong>
                        <a href="https://github.com/lenzarchive/ube-gui" target="_blank">Source Code</a>
                    </div>
                </div>
                <p class="disclaimer"><strong>Disclaimer:</strong> This tool is for educational and research purposes only. Ensure you have legal permission before extracting assets from any Unity project.</p>
                <p class="license">Licensed under the MIT License. Credit to @lenzarchive (alwizba).</p>
            </div>
        </footer>
    </div>

    <div id="custom-confirm-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h3 id="modal-title">Confirm Action</h3>
            <p id="modal-message"></p>
            <div class="modal-buttons">
                <button id="modal-confirm-button" class="action-button cancel-button">Stop</button> <button id="modal-cancel-button" class="action-button primary-button">Continue</button> </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>